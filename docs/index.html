<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Laravel Traffic Control Documentation</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <style>
        body {
            scroll-behavior: smooth;
        }

        .sidebar {
            height: 100vh;
            position: sticky;
            top: 0;
            overflow-y: auto;
            background: #f8f9fa;
            padding-top: 1rem;
        }

        .sidebar a {
            display: block;
            padding: 0.5rem 1rem;
            color: #333;
            text-decoration: none;
        }

        .sidebar a:hover {
            background: #e9ecef;
        }

        .sidebar .nav-link.active {
            background: #d63384;
            color: white !important;
        }

        pre {
            background: #f8f9fa;
            padding: 1rem;
            border-radius: 0.25rem;
            overflow-x: auto;
        }

        code {
            color: #d63384;
        }

        .content {
            padding: 2rem;
        }

        .collapse-button {
            cursor: pointer;
        }
    </style>
</head>

<body>
    <div class="container-fluid">
        <div class="row">
            <!-- Sidebar -->
            <nav class="col-md-3 col-lg-2 d-md-block sidebar collapse show" id="sidebarMenu">
                <h5 class="text-center">ðŸš¦ Laravel Traffic Control</h5>
                <div class="accordion" id="sidebarAccordion">
                    <div class="accordion-item">
                        <h2 class="accordion-header" id="headingInstall">
                            <button class="accordion-button" type="button" data-bs-toggle="collapse"
                                data-bs-target="#collapseInstall" aria-expanded="true" aria-controls="collapseInstall">
                                Installation
                            </button>
                        </h2>
                        <div id="collapseInstall" class="accordion-collapse collapse show"
                            aria-labelledby="headingInstall" data-bs-parent="#sidebarAccordion">
                            <div class="accordion-body">
                                <a href="#install">Install via Composer</a>
                                <a href="#publish">Publish Assets</a>
                            </div>
                        </div>
                    </div>
                    <div class="accordion-item">
                        <h2 class="accordion-header" id="headingConfig">
                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                                data-bs-target="#collapseConfig" aria-expanded="false" aria-controls="collapseConfig">
                                Configuration
                            </button>
                        </h2>
                        <div id="collapseConfig" class="accordion-collapse collapse" aria-labelledby="headingConfig"
                            data-bs-parent="#sidebarAccordion">
                            <div class="accordion-body">
                                <a href="#config">Full Config Explanation</a>
                            </div>
                        </div>
                    </div>
                    <div class="accordion-item">
                        <h2 class="accordion-header" id="headingUsage">
                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                                data-bs-target="#collapseUsage" aria-expanded="false" aria-controls="collapseUsage">
                                Usage
                            </button>
                        </h2>
                        <div id="collapseUsage" class="accordion-collapse collapse" aria-labelledby="headingUsage"
                            data-bs-parent="#sidebarAccordion">
                            <div class="accordion-body">
                                <a href="#middleware">Middleware</a>
                                <a href="#role-limit">Role / Plan Limits</a>
                                <a href="#api-quota">API Quotas</a>
                                <a href="#dashboard">Dashboard</a>
                                <a href="#alerts">Alerts</a>
                                <a href="#purge">Purging Logs</a>
                            </div>
                        </div>
                    </div>
                    <div class="accordion-item">
                        <h2 class="accordion-header" id="headingExtend">
                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                                data-bs-target="#collapseExtend" aria-expanded="false" aria-controls="collapseExtend">
                                Extending
                            </button>
                        </h2>
                        <div id="collapseExtend" class="accordion-collapse collapse" aria-labelledby="headingExtend"
                            data-bs-parent="#sidebarAccordion">
                            <div class="accordion-body">
                                <a href="#custom-rules">Custom Rules</a>
                            </div>
                        </div>
                    </div>
                    <div class="accordion-item">
                        <h2 class="accordion-header" id="headingOther">
                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                                data-bs-target="#collapseOther" aria-expanded="false" aria-controls="collapseOther">
                                Other
                            </button>
                        </h2>
                        <div id="collapseOther" class="accordion-collapse collapse" aria-labelledby="headingOther"
                            data-bs-parent="#sidebarAccordion">
                            <div class="accordion-body">
                                <a href="#roadmap">Roadmap</a>
                                <a href="#contributing">Contributing</a>
                                <a href="#license">License</a>
                            </div>
                        </div>
                    </div>
                </div>
            </nav>

            <!-- Content -->
            <main class="col-md-9 ms-sm-auto col-lg-10 content">
                <h1 id="top">Laravel Traffic Control ðŸš¦</h1>
                <p><strong>Description:</strong> Traffic control toolkit for Laravel â€” advanced throttling, blocking,
                    bot
                    detection, analytics, and dashboard.</p>

                <hr>

                <h2 id="screenshots">ðŸ“¸ Screenshots</h2>
                <p>Overview of dashboard, IP management, and settings pages:</p>

                <div class="row g-3">
                    <div class="col-md-4 col-sm-6">
                        <div class="card shadow-sm border-0">
                            <img src="../public/images/dashboard.png" class="card-img-top img-fluid rounded"
                                alt="Dashboard">
                            <div class="card-body text-center">
                                <h6 class="card-title">Dashboard</h6>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4 col-sm-6">
                        <div class="card shadow-sm border-0">
                            <img src="../public/images/manage-ip.png" class="card-img-top img-fluid rounded"
                                alt="Manage IP">
                            <div class="card-body text-center">
                                <h6 class="card-title">Manage IP</h6>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4 col-sm-6">
                        <div class="card shadow-sm border-0">
                            <img src="../public/images/settings.png" class="card-img-top img-fluid rounded"
                                alt="Settings">
                            <div class="card-body text-center">
                                <h6 class="card-title">Settings</h6>
                            </div>
                        </div>
                    </div>
                </div>

                <h2 id="install">Installation</h2>
                <pre><code>composer require areia-lab/laravel-traffic-control</code></pre>

                <h3 id="publish">Publish Configuration and Migrations</h3>
                <pre><code>php artisan vendor:publish --provider="AreiaLab\TrafficControl\TrafficControlServiceProvider" --tag="config"
php artisan vendor:publish --provider="AreiaLab\TrafficControl\TrafficControlServiceProvider" --tag="migrations"
php artisan migrate

# Optional dashboard views
php artisan vendor:publish --provider="AreiaLab\TrafficControl\TrafficControlServiceProvider" --tag="traffic-views"</code></pre>

                <hr>
                <h2 id="config">Configuration</h2>
                <p>Edit <code>config/traffic.php</code>. Key explanations:</p>
                <ul>
                    <li><strong>enabled</strong> â€” Enable or disable traffic control globally.</li>
                    <li><strong>storage</strong> â€” Storage driver for logs and counters: redis, database, or file.</li>
                    <li><strong>rate_limits</strong> â€” Requests per time window per profile.</li>
                    <li><strong>ip</strong> â€” IP control: blacklist, whitelist, block_tor.</li>
                    <li><strong>bot_detection</strong> â€” Enable bot User-Agent detection.</li>
                    <li><strong>alerts</strong> â€” Slack/email alerts and threshold.</li>
                    <li><strong>dashboard</strong> â€” Enable dashboard, route prefix, and middleware.</li>
                    <li><strong>api_quota</strong> â€” Per-user or plan request limits.</li>
                    <li><strong>logging</strong> â€” Log blocked requests and sampling rate.</li>
                </ul>
                <pre><code>&lt;?php
return [
    'enabled' =&gt; true,
    'storage' =&gt; 'redis',
    'rate_limits' =&gt; [
        'default' =&gt; ['requests' =&gt; 60, 'per' =&gt; 60],
        'api' =&gt; ['requests' =&gt; 120, 'per' =&gt; 60],
    ],
    'ip' =&gt; [
        'blacklist' =&gt; [],
        'whitelist' =&gt; [],
        'block_tor' =&gt; true,
    ],
    'bot_detection' =&gt; [
        'enabled' =&gt; true,
        'user_agents' =&gt; ['bad-bot'],
    ],
    'alerts' =&gt; [
        'slack' =&gt; env('TRAFFIC_CONTROL_SLACK_WEBHOOK'),
        'email' =&gt; env('TRAFFIC_CONTROL_ALERT_EMAIL'),
        'threshold' =&gt; 1000,
    ],
    'dashboard' =&gt; [
        'enabled' =&gt; true,
        'prefix' =&gt; 'traffic-control',
        'middleware' =&gt; ['web'],
    ],
    'api_quota' =&gt; ['default' =&gt; 10000],
    'logging' =&gt; ['log_blocked' =&gt; true, 'log_sample_rate' =&gt; 1],
];</code></pre>

                <hr>
                <h2 id="middleware">Usage: Middleware</h2>
                <pre><code>Route::middleware(['traffic.control'])->group(function () {
    Route::get('/api/data', [ApiController::class, 'index']);
});

// Custom limits per route
Route::get('/heavy', [HeavyController::class, 'index'])
    -&gt;middleware('traffic.control:200,60');</code></pre>

                <h2 id="role-limit">Role / Plan-Based Limits</h2>
                <pre><code>if ($user = $request-&gt;user()) {
    $plan = $user-&gt;plan ?? 'free';
    $limit = config("traffic-control.rate_limits.$plan", config('traffic-control.rate_limits.default'));
}</code></pre>

                <h2 id="api-quota">API Quotas</h2>
                <pre><code>use AreiaLab\TrafficControl\Facades\TrafficManager;

if (!TrafficManager::checkQuota($user-&gt;id)) {
    return response()-&gt;json(['error' =&gt; 'API quota exceeded'], 429);
}</code></pre>

                <h2 id="dashboard">Dashboard</h2>
                <pre><code>Route::get('/admin/traffic', function () {
    $logs = \AreiaLab\TrafficControl\Models\TrafficLog::latest()-&gt;limit(50)-&gt;get();
    return view('vendor.traffic-control.dashboard', compact('logs'));
})-&gt;middleware(['web','auth'])-&gt;name('traffic-control.dashboard');</code></pre>

                <h2 id="alerts">Alerts</h2>
                <pre><code>TRAFFIC_CONTROL_SLACK_WEBHOOK=https://hooks.slack.com/services/XXXX
TRAFFIC_CONTROL_ALERT_EMAIL=admin@example.com</code></pre>

                <h2 id="purge">Purging Logs</h2>
                <pre><code>php artisan traffic-control:purge
php artisan traffic-control:purge --days=90 --force
php artisan traffic-control:purge --all
php artisan traffic-control:purge --all --force</code></pre>

                <hr>
                <h2 id="custom-rules">Extending: Custom Rules</h2>
                <pre><code>namespace AreiaLab\TrafficControl\Rules;

use Illuminate\Http\Request;

class GeoBlockRule
{
    public function handle(Request $request)
    {
        $country = $this-&gt;lookupCountry($request-&gt;ip());
        if (in_array($country, ['CN', 'RU'])) {
            return response('Not available in your region', 403);
        }
        return true;
    }

    protected function lookupCountry($ip)
    {
        return 'US';
    }
}</code></pre>

                <h2 id="roadmap">Roadmap</h2>
                <ul>
                    <li>Redis sliding window / leaky bucket limiter</li>
                    <li>GeoIP/TOR/VPN detection integration</li>
                    <li>Charts for dashboard</li>
                    <li>Plan-based quota & billing hooks</li>
                    <li>AI anomaly detection</li>
                </ul>

                <h2 id="contributing">Contributing</h2>
                <p>PRs welcome. Follow PSR-12, add tests, and update README.</p>

                <h2 id="license">License</h2>
                <p>MIT Â© AreiaLab</p>
            </main>
        </div>
    </div>
</body>

</html>